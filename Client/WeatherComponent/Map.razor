@page "/get-location"

<h3>Get Location</h3>

<form @onsubmit="GetLocation">
    <label for="location" @bind-="Location">Enter Location:</label>
    <input type="text" id="location" @bind="Location" />
    <button type="submit">Get Coordinates</button>
</form>

<p>@CoordinatesMessage</p>

@code {
    private string Location { get; set; }
    private string CoordinatesMessage { get; set; }

    private async Task GetLocation()
    {
        string url = $"https://nominatim.openstreetmap.org/search?q={Location}&format=json";

        try
        {
            using (var httpClient = new HttpClient())
            {
                var response = await httpClient.GetAsync(url);
                response.EnsureSuccessStatusCode();
                var data = await response.Content.ReadFromJsonAsync<dynamic[]>();

                if (data != null && data.Length > 0)
                {
                    var latitude = data[0].lat;
                    var longitude = data[0].lon;
                    CoordinatesMessage = $"Latitude: {latitude}, Longitude: {longitude}";
                }
                else
                {
                    CoordinatesMessage = "Location not found.";
                }
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"An error occurred: {ex.Message}");
            CoordinatesMessage = "An error occurred while fetching location data.";
        }
    }
}
